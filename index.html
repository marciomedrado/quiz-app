<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Gerador de Quizzes com IA - Crie quizzes estruturados usando OpenAI">
    <title>Quiz Generator - Powered by OpenAI</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Outfit:wght@400;700&family=Poppins:wght@400;700&family=Montserrat:wght@400;700&family=Playfair+Display:wght@700&family=Roboto:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- SheetJS for Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div
                style="display: flex; justify-content: space-between; align-items: center; max-width: 800px; margin: 0 auto;">
                <div style="flex: 1;">
                    <h1>üéØ Quiz Generator</h1>
                    <div id="userInfo" class="user-info-bar hidden">
                        <span id="userEmail" style="opacity: 0.8;"></span>
                        <div class="credit-badge">
                            <span id="userCredits">0</span> ü™ô cr√©ditos
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: var(--space-xs); align-items: center;">
                    <button id="adminBtn" class="btn btn-secondary hidden" style="border-color: var(--color-accent);">
                        üëë Admin
                    </button>
                    <button id="logoutBtn" class="btn btn-secondary">
                        ÔøΩ Sair
                    </button>
                    <button id="settingsBtn" class="btn btn-secondary">
                        ‚öôÔ∏è Configura√ß√µes
                    </button>
                </div>
            </div>
        </header>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal hidden">
            <div class="modal-overlay"></div>
            <div class="modal-content glass-card">
                <div class="modal-header">
                    <h2>‚öôÔ∏è Configura√ß√µes OpenAI</h2>
                    <button id="closeSettings" class="btn-close">‚úï</button>
                </div>

                <div class="modal-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="apiKey" class="form-label">
                                Chave API OpenAI <span class="required">*</span>
                            </label>
                            <input type="password" id="apiKey" class="form-input" placeholder="YOUR_OPENAI_API_KEY"
                                autocomplete="off">
                            <small class="form-help">Sua chave ser√° armazenada localmente no navegador</small>
                        </div>

                        <div class="form-group">
                            <label for="model" class="form-label">Modelo OpenAI (Texto)</label>
                            <select id="model" class="form-select">
                                <option value="gpt-5.2">GPT-5.2 (Ponta / L√≥gica avan√ßada)</option>
                                <option value="gpt-5-mini">GPT-5 Mini (Equilibrado)</option>
                                <option value="gpt-5-nano">GPT-5 Nano (Ultra-r√°pido)</option>
                                <option value="gpt-4.1">GPT-4.1 (Vers√°til / Explicativo)</option>
                                <option value="gpt-4.1-mini">GPT-4.1 Mini (Econ√¥mico)</option>
                                <option value="gpt-4.1-nano">GPT-4.1 Nano (Performance)</option>
                                <option value="gpt-4o">GPT-4o (Mais usado)</option>
                                <option value="gpt-4o-mini">GPT-4o Mini</option>
                                <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                            </select>
                            <small class="form-help">Modelos mais avan√ßados geram quizzes de maior qualidade</small>
                        </div>
                    </div>

                    <div class="form-grid mt-md"
                        style="border-top: 1px solid var(--glass-border); padding-top: var(--space-md);">
                        <div class="form-group">
                            <label for="imageProvider" class="form-label">Provedor de Imagem (IA)</label>
                            <select id="imageProvider" class="form-select">
                                <option value="openai">OpenAI DALL-E 3</option>
                                <option value="google">Google Imagen (Whisk)</option>
                            </select>
                        </div>
                        <div class="form-group hidden" id="googleKeyGroup">
                            <label for="googleApiKey" class="form-label">Chave API Google Gemini (Imagen)</label>
                            <input type="password" id="googleApiKey" class="form-input"
                                placeholder="YOUR_GOOGLE_API_KEY" autocomplete="off">
                            <small class="form-help">Necess√°ria para o Google Imagen</small>
                        </div>
                    </div>

                    <div class="form-grid mt-md"
                        style="border-top: 1px solid var(--glass-border); padding-top: var(--space-md);">
                        <div class="form-group">
                            <label for="googleSearchKey" class="form-label">Google Search API Key (Busca
                                Imagens)</label>
                            <input type="password" id="googleSearchKey" class="form-input" placeholder="YOUR_GOOGLE_CX"
                                autocomplete="off">
                            <small class="form-help">Para buscar imagens reais no Google</small>
                        </div>
                        <div class="form-group">
                            <label for="googleSearchCx" class="form-label">Google Search Engine ID (CX)</label>
                            <input type="text" id="googleSearchCx" class="form-input" placeholder="012345..."
                                autocomplete="off">
                            <small class="form-help">ID do mecanismo de busca program√°vel</small>
                        </div>
                    </div>
                </div>

                <div class="modal-footer" style="display: flex; gap: var(--space-sm); justify-content: flex-end;">
                    <button id="openStyleModal" class="btn btn-secondary">
                        üé® Personalizar Estilo
                    </button>
                    <button id="openTimingModal" class="btn btn-secondary">
                        ‚è±Ô∏è Ajustar Tempos
                    </button>
                    <button id="saveApiKey" class="btn btn-primary">
                        üíæ Salvar Configura√ß√£o
                    </button>
                    <button id="cancelSettings" class="btn btn-secondary">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>

        <!-- Image Search Modal -->
        <div id="imageSearchModal" class="modal hidden">
            <div class="modal-overlay"></div>
            <div class="modal-content glass-card" style="max-width: 800px;">
                <div class="modal-header">
                    <h2>üîç Busca de Imagens (CC)</h2>
                    <button id="closeImageSearch" class="btn-close">‚úï</button>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-md">
                        <div style="display: flex; gap: var(--space-sm);">
                            <input type="text" id="imageSearchInput" class="form-input" placeholder="Buscar imagens...">
                            <button id="executeImageSearch" class="btn btn-primary btn-sm">Buscar</button>
                        </div>
                        <small class="form-help">Resultados filtrados por licenciamento Creative Commons</small>
                    </div>
                    <div id="imageSearchResults" class="image-results-grid">
                        <!-- Resultados vir√£o aqui -->
                        <div class="image-placeholder" style="grid-column: 1/-1; padding: var(--space-xl);">
                            Digite um termo para buscar imagens reais no Google
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Style Customization Modal -->
        <div id="styleModal" class="modal hidden">
            <div class="modal-overlay"></div>
            <div class="modal-content glass-card" style="max-width: 1100px; width: 95%;">
                <div class="modal-header">
                    <h2>üé® Personaliza√ß√£o Visual</h2>
                    <button id="closeStyleModal" class="btn-close">‚úï</button>
                </div>
                <div class="modal-body"
                    style="display: grid; grid-template-columns: 380px 1fr; gap: var(--space-xl); height: 75vh; padding: 0; overflow: hidden;">
                    <!-- Controls (Scrollable) -->
                    <div class="style-controls"
                        style="display: flex; flex-direction: column; gap: var(--space-md); overflow-y: auto; padding: 25px; border-right: 1px solid var(--glass-border);">
                        <!-- Color Palettes -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                üé® Paletas R√°pidas</h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                                <button type="button" class="palette-btn" onclick="applyColorPalette('default')"
                                    title="Padr√£o">
                                    <div class="palette-colors">
                                        <span style="background: #6366f1;"></span>
                                        <span style="background: #a855f7;"></span>
                                    </div>
                                    <span class="palette-name">Padr√£o</span>
                                </button>
                                <button type="button" class="palette-btn" onclick="applyColorPalette('ocean')"
                                    title="Oceano">
                                    <div class="palette-colors">
                                        <span style="background: #14b8a6;"></span>
                                        <span style="background: #06b6d4;"></span>
                                    </div>
                                    <span class="palette-name">Oceano</span>
                                </button>
                                <button type="button" class="palette-btn" onclick="applyColorPalette('sunset')"
                                    title="P√¥r do Sol">
                                    <div class="palette-colors">
                                        <span style="background: #f97316;"></span>
                                        <span style="background: #ec4899;"></span>
                                    </div>
                                    <span class="palette-name">P√¥r do Sol</span>
                                </button>
                                <button type="button" class="palette-btn" onclick="applyColorPalette('forest')"
                                    title="Floresta">
                                    <div class="palette-colors">
                                        <span style="background: #22c55e;"></span>
                                        <span style="background: #84cc16;"></span>
                                    </div>
                                    <span class="palette-name">Floresta</span>
                                </button>
                                <button type="button" class="palette-btn" onclick="applyColorPalette('royal')"
                                    title="Real">
                                    <div class="palette-colors">
                                        <span style="background: #9333ea;"></span>
                                        <span style="background: #6366f1;"></span>
                                    </div>
                                    <span class="palette-name">Real</span>
                                </button>
                                <button type="button" class="palette-btn" onclick="applyColorPalette('fire')"
                                    title="Fogo">
                                    <div class="palette-colors">
                                        <span style="background: #ef4444;"></span>
                                        <span style="background: #f97316;"></span>
                                    </div>
                                    <span class="palette-name">Fogo</span>
                                </button>
                                <button type="button" class="palette-btn" onclick="applyColorPalette('night')"
                                    title="Noite">
                                    <div class="palette-colors">
                                        <span style="background: #1e40af;"></span>
                                        <span style="background: #7c3aed;"></span>
                                    </div>
                                    <span class="palette-name">Noite</span>
                                </button>
                                <button type="button" class="palette-btn" onclick="applyColorPalette('pastel')"
                                    title="Pastel">
                                    <div class="palette-colors">
                                        <span style="background: #f9a8d4;"></span>
                                        <span style="background: #93c5fd;"></span>
                                    </div>
                                    <span class="palette-name">Pastel</span>
                                </button>
                            </div>
                        </div>
                        <!-- Style Presets -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                üíæ Meus Presets</h3>
                            <div class="form-group mb-xs">
                                <div style="display: flex; gap: 8px;">
                                    <input type="text" id="presetNameInput" class="form-input"
                                        placeholder="Nome do preset..." style="font-size: 0.8rem; height: 32px;">
                                    <button id="savePresetBtn" class="btn btn-primary btn-sm"
                                        style="white-space: nowrap; height: 32px; padding: 0 12px;">Salvar</button>
                                </div>
                            </div>
                            <div id="presetsList"
                                style="display: flex; flex-direction: column; gap: 6px; max-height: 200px; overflow-y: auto; padding: 10px; background: rgba(0,0,0,0.25); border-radius: var(--radius-sm); border: 1px solid var(--glass-border);">
                                <!-- Presets will be loaded here -->
                                <div
                                    style="text-align: center; font-size: 0.75rem; color: var(--text-tertiary); padding: 5px;">
                                    Nenhum preset salvo</div>
                            </div>
                        </div>
                        <!-- Brand Colors -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                Cores Base (Marca)</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div class="form-group">
                                    <label class="form-label">Prim√°ria</label>
                                    <input type="color" id="cardColorPrimary" value="#6366f1" class="form-input-color">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Destaque</label>
                                    <input type="color" id="cardColorAccent" value="#a855f7" class="form-input-color">
                                </div>
                            </div>
                        </div>

                        <!-- Question Number -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                üìç N√∫mero da Quest√£o</h3>
                            <div class="form-group mb-xs">
                                <label class="form-label">Formato do N√∫mero</label>
                                <select id="cardNumberFormat" class="form-select">
                                    <option value="question">Quest√£o {n}</option>
                                    <option value="pergunta">Pergunta {n}</option>
                                    <option value="none">{n} (Apenas n√∫mero)</option>
                                </select>
                            </div>
                            <div class="form-group mb-xs">
                                <label class="form-label">Fonte</label>
                                <select id="cardFontFamilyNumber" class="form-select font-selector-ajax"></select>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; align-items: end;">
                                <div class="form-group">
                                    <label class="form-label">Tamanho (<span
                                            id="fontSizeNumberValue">100</span>%)</label>
                                    <input type="range" id="cardFontSizeNumber" min="50" max="250" value="100"
                                        class="form-range" style="width: 100%;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Curvatura Cantos (<span
                                            id="radiusNumberValue">15</span>px)</label>
                                    <input type="range" id="cardRadiusNumber" min="0" max="100" value="15"
                                        class="form-range">
                                </div>
                            </div>
                            <div class="form-group mt-xs">
                                <label class="form-label">Cor do Texto</label>
                                <input type="color" id="cardColorTextNumber" value="#ffffff" class="form-input-color">
                            </div>
                        </div>

                        <!-- Question Statement -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                ‚ùì Enunciado</h3>
                            <div class="form-group mb-xs">
                                <label class="form-label">Fonte</label>
                                <select id="cardFontFamilyQuestion" class="form-select font-selector-ajax"></select>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; align-items: end;">
                                <div class="form-group">
                                    <label class="form-label">Tamanho (<span
                                            id="fontSizeQuestionValue">100</span>%)</label>
                                    <input type="range" id="cardFontSizeQuestion" min="50" max="250" value="100"
                                        class="form-range" style="width: 100%;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Cor do Texto</label>
                                    <input type="color" id="cardColorTextQuestion" value="#ffffff"
                                        class="form-input-color">
                                </div>
                            </div>
                        </div>

                        <!-- Alternatives -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                üîò Alternativas</h3>
                            <div class="form-group mb-xs">
                                <label class="form-label">Fonte</label>
                                <select id="cardFontFamilyAlternatives" class="form-select font-selector-ajax"></select>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; align-items: end;">
                                <div class="form-group">
                                    <label class="form-label">Tamanho (<span
                                            id="fontSizeAlternativesValue">100</span>%)</label>
                                    <input type="range" id="cardFontSizeAlternatives" min="50" max="250" value="100"
                                        class="form-range" style="width: 100%;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Curvatura Cantos (<span
                                            id="radiusAlternativesValue">20</span>px)</label>
                                    <input type="range" id="cardRadiusAlternatives" min="0" max="100" value="20"
                                        class="form-range">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Largura do Box (<span
                                            id="widthAlternativesValue">100</span>%)</label>
                                    <input type="range" id="cardWidthAlternatives" min="40" max="100" value="100"
                                        class="form-range">
                                </div>
                            </div>
                            <div class="form-group mt-xs">
                                <label class="form-label">Cor do Texto</label>
                                <input type="color" id="cardColorTextAlternatives" value="#ffffff"
                                    class="form-input-color">
                            </div>
                            <!-- Global Alternatives Box Controls -->
                            <div
                                style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm); border: 1px solid var(--glass-border);">
                                <p
                                    style="font-size: 0.75rem; color: var(--color-primary-light); font-weight: 700; margin-bottom: 8px; text-transform: uppercase;">
                                    Ajuste Global dos Boxes</p>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                    <div class="form-group">
                                        <label class="form-label">Opacidade Fundo (<span
                                                id="globalAltBgOpacityValue">0.05</span>)</label>
                                        <input type="range" id="globalAltBgOpacity" min="0" max="1" step="0.05"
                                            value="0.05" class="form-range">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Opacidade Borda (<span
                                                id="globalAltBorderOpacityValue">0.1</span>)</label>
                                        <input type="range" id="globalAltBorderOpacity" min="0" max="1" step="0.05"
                                            value="0.1" class="form-range">
                                    </div>
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 8px;">
                                    <div class="form-group">
                                        <label class="form-label">Cor Fundo Box</label>
                                        <input type="color" id="globalAltBgColor" value="#ffffff"
                                            class="form-input-color">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cor Borda Box</label>
                                        <input type="color" id="globalAltBorderColor" value="#ffffff"
                                            class="form-input-color">
                                    </div>
                                </div>
                                <small style="display: block; margin-top: 5px; opacity: 0.6; font-size: 0.7rem;">*
                                    Altera todos os cards que n√£o possuam ajuste individual.</small>
                            </div>
                        </div>

                        <!-- Justification -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                üí° Justificativa (Resposta)</h3>
                            <div class="form-group mb-xs">
                                <label class="form-label">Fonte</label>
                                <select id="cardFontFamilyJustification"
                                    class="form-select font-selector-ajax"></select>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; align-items: end;">
                                <div class="form-group">
                                    <label class="form-label">Tamanho (<span
                                            id="fontSizeJustificationValue">100</span>%)</label>
                                    <input type="range" id="cardFontSizeJustification" min="50" max="250" value="100"
                                        class="form-range" style="width: 100%;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Curvatura Cantos (<span
                                            id="radiusJustificationValue">20</span>px)</label>
                                    <input type="range" id="cardRadiusJustification" min="0" max="100" value="20"
                                        class="form-range">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Largura do Box (<span
                                            id="widthJustificationValue">100</span>%)</label>
                                    <input type="range" id="cardWidthJustification" min="40" max="100" value="100"
                                        class="form-range">
                                </div>
                            </div>
                            <div class="form-group mt-xs">
                                <label class="form-label">Cor do Texto</label>
                                <input type="color" id="cardColorTextJustification" value="#ffffff"
                                    class="form-input-color">
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                                <div class="form-group">
                                    <label class="form-label">Cor Fundo (Correta)</label>
                                    <input type="color" id="cardColorCorrect" value="#22c55e" class="form-input-color">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Cor Borda (Correta)</label>
                                    <input type="color" id="cardColorCorrectBorder" value="#22c55e"
                                        class="form-input-color">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Fundo do Box</label>
                                    <input type="color" id="cardColorJustificationBg" value="#166534"
                                        class="form-input-color">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 10px;">
                                <label class="form-label">Cor da Borda Lateral (Box)</label>
                                <input type="color" id="cardColorJustificationBorder" value="#22c55e"
                                    class="form-input-color">
                            </div>
                        </div>

                        <!-- Background -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                üñºÔ∏è Fundo / Background</h3>

                            <!-- Fio Section -->
                            <div
                                style="margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm); border: 1px solid var(--glass-border);">
                                <div
                                    style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                                    <label class="form-label" style="margin-bottom: 0;">Inclus√£o de Fio (Inner
                                        Border)</label>
                                    <input type="checkbox" id="cardFioVisible" style="width: 18px; height: 18px;">
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                    <div class="form-group">
                                        <label class="form-label">Cor do Fio</label>
                                        <input type="color" id="cardFioColor" value="#ffffff" class="form-input-color">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Curvatura (<span
                                                id="radiusFioValue">10</span>px)</label>
                                        <input type="range" id="cardRadiusFio" min="0" max="100" value="10"
                                            class="form-range">
                                    </div>
                                </div>
                                <div
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                                    <div class="form-group">
                                        <label class="form-label">Dist√¢ncia Borda (<span
                                                id="fioOffsetValue">10</span>px)</label>
                                        <input type="range" id="cardFioOffset" min="5" max="150" value="10"
                                            class="form-range">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Espessura (<span
                                                id="fioThicknessValue">1</span>px)</label>
                                        <input type="range" id="cardFioThickness" min="1" max="30" value="1"
                                            class="form-range">
                                    </div>
                                </div>
                            </div>

                            <p
                                style="font-size: 0.7rem; color: var(--color-primary-light); font-weight: 700; margin: 5px 0 10px 0; text-transform: uppercase;">
                                Ajuste Global (Todos os Cards)</p>
                            <div class="form-group mb-sm">
                                <label class="form-label">Cor de Fundo</label>
                                <input type="color" id="cardColorBg" value="#1e1e2e" class="form-input-color">
                            </div>
                            <div class="form-group mb-sm">
                                <label class="form-label">URL Imagem de Fundo</label>
                                <input type="text" id="cardBgImage" class="form-input"
                                    placeholder="https://exemplo.com/imagem.jpg">
                            </div>
                            <div class="form-group mb-sm">
                                <label class="form-label">Ou Upload do Dispositivo</label>
                                <input type="file" id="cardBgUpload" class="form-input" accept="image/*">
                            </div>
                            <div class="form-group mb-sm">
                                <label class="form-label">Opacidade da Imagem (<span
                                        id="bgImageOpacityValue">1.0</span>)</label>
                                <input type="range" id="cardBgImageOpacity" min="0" max="1" step="0.1" value="1.0"
                                    class="form-range" style="width: 100%;">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Opacidade do Overlay (<span
                                        id="bgOpacityValue">0.5</span>)</label>
                                <input type="range" id="cardBgOpacity" min="0" max="1" step="0.1" value="0.5"
                                    class="form-range" style="width: 100%;">
                            </div>
                        </div>

                        <!-- Vertical Positioning -->
                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                ‚ÜïÔ∏è Posicionamento Vertical (Eixo Y)</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div class="form-group">
                                    <label class="form-label">Box de Quest√£o (<span
                                            id="yOffsetNumberValue">-20</span>px)</label>
                                    <input type="range" id="cardYOffsetNumber" min="-200" max="200" value="-20"
                                        class="form-range">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Enunciado (<span
                                            id="yOffsetQuestionValue">-28</span>px)</label>
                                    <input type="range" id="cardYOffsetQuestion" min="-200" max="200" value="-28"
                                        class="form-range">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Alternativas (<span
                                            id="yOffsetAlternativesValue">-20</span>px)</label>
                                    <input type="range" id="cardYOffsetAlternatives" min="-200" max="200" value="-20"
                                        class="form-range">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Alts (c/ Imagem) (<span
                                            id="yOffsetAlternativesImageValue">-22</span>px)</label>
                                    <input type="range" id="cardYOffsetAlternativesImage" min="-200" max="200"
                                        value="-22" class="form-range">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Justificativa (<span
                                            id="yOffsetJustificationValue">0</span>px)</label>
                                    <input type="range" id="cardYOffsetJustification" min="-200" max="200" value="0"
                                        class="form-range">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Imagem √† Direita (<span
                                            id="yOffsetImageValue">-16</span>px)</label>
                                    <input type="range" id="cardYOffsetImage" min="-200" max="200" value="-16"
                                        class="form-range">
                                </div>
                            </div>
                            <small style="display: block; margin-top: 5px; opacity: 0.6; font-size: 0.7rem;">* Valores
                                negativos sobem, positivos descem.</small>
                        </div>

                        <div class="style-section">
                            <h3 class="mb-sm"
                                style="font-size: 1.1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 5px;">
                                ‚ö° Configura√ß√µes de Pr√©via</h3>
                            <div class="form-group mb-sm">
                                <label class="form-label">Layout da Pr√©via</label>
                                <select id="cardPreviewLayout" class="form-select">
                                    <option value="default">Layout Padr√£o</option>
                                    <option value="image-right">Imagem √† Direita</option>
                                </select>
                            </div>
                            <div class="form-group mb-sm">
                                <label class="form-label">Tipo de Tela</label>
                                <select id="cardPreviewScreen" class="form-select">
                                    <option value="question">Enunciado (Pergunta)</option>
                                    <option value="answer">Resposta (Justificativa)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Quantidade de Alternativas</label>
                                <select id="cardPreviewAlternatives" class="form-select">
                                    <option value="2">2 alternativas</option>
                                    <option value="3">3 alternativas</option>
                                    <option value="4" selected>4 alternativas</option>
                                    <option value="5">5 alternativas</option>
                                </select>
                            </div>
                        </div>

                        <div class="btn-group mt-sm">
                            <button id="resetStyles" class="btn btn-secondary btn-sm" style="width: 100%;">Restaurar
                                Padr√£o</button>
                        </div>
                    </div>

                    <!-- Preview (Fixed) -->
                    <div class="style-preview-container"
                        style="display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding: 25px; overflow: hidden;">
                        <label class="form-label mb-sm" style="text-align: center; display: block; width: 100%;">Pr√©via
                            (16:9)</label>
                        <div id="cardPreviewWrapper" class="card-preview-wrapper"
                            style="transform: scale(0.32); transform-origin: top center;">
                            <!-- O preview ser√° injetado aqui via JS -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="saveStyles" class="btn btn-primary">üíæ Salvar Estilo</button>
                    <button id="cancelStyles" class="btn btn-secondary">Fechar</button>
                </div>
            </div>
        </div>

        <!-- Quiz Configuration Card -->
        <section class="glass-card mb-lg">
            <div class="card-header">
                <h2>üìù Configura√ß√£o do Quiz</h2>
                <p>Defina os par√¢metros para gera√ß√£o do seu quiz</p>
            </div>

            <div class="form-grid">
                <div class="form-group">
                    <label for="language" class="form-label">
                        Idioma <span class="required">*</span>
                    </label>
                    <select id="language" class="form-select">
                        <option value="Portugu√™s">Portugu√™s</option>
                        <option value="English">English</option>
                        <option value="Espa√±ol">Espa√±ol</option>
                        <option value="Fran√ßais">Fran√ßais</option>
                        <option value="Deutsch">Deutsch</option>
                        <option value="Italiano">Italiano</option>
                        <option value="Êó•Êú¨Ë™û">Êó•Êú¨Ë™û</option>
                        <option value="‰∏≠Êñá">‰∏≠Êñá</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="theme" class="form-label">
                        Tema <span class="required">*</span>
                    </label>
                    <input type="text" id="theme" class="form-input"
                        placeholder="Ex: Hist√≥ria do Brasil, Matem√°tica, Cinema...">
                </div>

                <div class="form-group">
                    <label for="difficulty" class="form-label">
                        N√≠vel de Dificuldade <span class="required">*</span>
                    </label>
                    <select id="difficulty" class="form-select">
                        <option value="Iniciante">Iniciante (Fato isolado / √ìbvio)</option>
                        <option value="B√°sico">B√°sico (Conhecimento comum / Mem√≥ria simples)</option>
                        <option value="Intermedi√°rio">Intermedi√°rio (Compara√ß√£o / Pequenas infer√™ncias)</option>
                        <option value="Avan√ßado">Avan√ßado (Contexto / Interpreta√ß√£o / M√∫ltiplos conceitos)</option>
                        <option value="Especialista">Especialista (T√©cnico / Termos espec√≠ficos / Exce√ß√µes)</option>
                        <option value="Mestre">Mestre (Armadilhas / Conex√µes indiretas / Estrat√©gico)</option>
                        <option value="Extremo">Extremo / Desafio Supremo (Acad√™mico / Paradoxos / Pegadinhas)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="format" class="form-label">
                        Formato <span class="required">*</span>
                    </label>
                    <select id="format" class="form-select">
                        <option value="R√°pido">Quiz R√°pido (10 quest√µes)</option>
                        <option value="Longo">Quiz Longo (20-100 quest√µes)</option>
                        <option value="S√©rie">S√©rie (Multi-parte)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="numQuestions" class="form-label">
                        N√∫mero de Quest√µes <span class="required">*</span>
                    </label>
                    <input type="number" id="numQuestions" class="form-input" min="5" max="100" value="10">
                    <small class="form-help">Entre 5 e 100 quest√µes</small>
                </div>

                <div class="form-group">
                    <label for="numAlternatives" class="form-label">
                        N√∫mero de Alternativas <span class="required">*</span>
                    </label>
                    <select id="numAlternatives" class="form-select">
                        <option value="2">2 alternativas</option>
                        <option value="3">3 alternativas</option>
                        <option value="4" selected>4 alternativas</option>
                        <option value="5">5 alternativas</option>
                    </select>
                </div>
            </div>

            <!-- Configura√ß√µes de Narrativa -->
            <div class="card-header mt-lg"
                style="margin-bottom: var(--space-md); border-top: 1px solid var(--glass-border); padding-top: var(--space-lg);">
                <h3>üéôÔ∏è Configura√ß√µes de Narrativa</h3>
                <p>Personalize como o roteiro do seu quiz ser√° gerado</p>
            </div>

            <div class="form-grid">
                <div class="form-group">
                    <label for="channelName" class="form-label">Nome do Canal</label>
                    <input type="text" id="channelName" class="form-input" placeholder="Ex: Curiosidades Incr√≠veis">
                </div>

                <div class="form-group">
                    <label for="narratorTone" class="form-label">Tom do Narrador</label>
                    <select id="narratorTone" class="form-select" onchange="toggleCustomTone(this.value)">
                        <option value="Animado">Animado e En√©rgico</option>
                        <option value="Formal">Formal e Profissional</option>
                        <option value="Suspense">Suspense e Misterioso</option>
                        <option value="Educativo">Educativo e Calmo</option>
                        <option value="Personalizado">Personalizado...</option>
                    </select>
                </div>

                <div class="form-group hidden" id="customToneGroup">
                    <label for="customTone" class="form-label">Descreva o Tom</label>
                    <input type="text" id="customTone" class="form-input" placeholder="Ex: Homem idoso, s√°bio e lento">
                </div>

                <div class="form-group">
                    <label for="narrativeQuestionFormat" class="form-label">Formato do N√∫mero (Narra√ß√£o)</label>
                    <select id="narrativeQuestionFormat" class="form-select">
                        <option value="flourished">Floreado (Variado)</option>
                        <option value="full">Completo (Quest√£o X)</option>
                        <option value="number-only" selected>Apenas N√∫mero</option>
                        <option value="none">Omitir</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="narrativeAlternativeFormat" class="form-label">Formato das Alternativas
                        (Narra√ß√£o)</label>
                    <select id="narrativeAlternativeFormat" class="form-select">
                        <option value="full" selected>Letra e Conte√∫do</option>
                        <option value="letter-only">Apenas Letras</option>
                        <option value="content-only">Apenas Conte√∫do</option>
                        <option value="omit">Omitir Tudo</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="narrativeAnswerFormat" class="form-label">Formato da Resposta (Narra√ß√£o)</label>
                    <select id="narrativeAnswerFormat" class="form-select">
                        <option value="full" selected>Completo (Letra + Conte√∫do)</option>
                        <option value="almost-full">Letra + Conte√∫do (Simples)</option>
                        <option value="keyword-only">Apenas Palavra "Resposta"</option>
                        <option value="content-only">Apenas o Conte√∫do</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="narrativeJustificationFormat" class="form-label">Justificativa (Card e Narra√ß√£o)</label>
                    <select id="narrativeJustificationFormat" class="form-select">
                        <option value="both" selected>Imprimir no card e ler na narra√ß√£o</option>
                        <option value="print-only">Imprimir no card e N√ÉO ler</option>
                        <option value="read-only">N√ÉO imprimir no card mas LER na narra√ß√£o</option>
                        <option value="none-both">N√ÉO imprimir e N√ÉO ler</option>
                    </select>
                </div>
            </div>

            <div class="form-group mt-md">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <label for="details" class="form-label" style="margin-bottom: 0;">Detalhes sobre o Tema</label>
                    <button id="openBrainstorm" class="btn btn-sm btn-secondary"
                        style="padding: 4px 10px; font-size: 0.75rem; border: 1px solid var(--glass-border); background: var(--glass-bg);">
                        üß† Brainstorm
                    </button>
                </div>
                <textarea id="details" class="form-textarea"
                    placeholder="Adicione informa√ß√µes espec√≠ficas, contexto ou requisitos especiais para o quiz..."></textarea>
                <small class="form-help">Opcional: Forne√ßa mais contexto para personalizar o quiz</small>
            </div>

            <div class="btn-group mt-lg">
                <button id="generateQuiz" class="btn btn-primary">
                    ‚ú® Gerar Quiz
                </button>
                <button id="clearForm" class="btn btn-secondary">
                    üîÑ Limpar Formul√°rio
                </button>
                <button id="importMetadataTop" class="btn btn-secondary">
                    üì• Importar Backup
                </button>
            </div>
        </section>

        <!-- Status Messages -->
        <div id="statusContainer"></div>

        <!-- Results Section -->
        <section id="resultsSection" class="hidden">
            <div class="glass-card">
                <div class="card-header">
                    <h2>üìä Quiz Gerado</h2>
                    <p id="quizSummary"></p>
                </div>

                <div class="btn-group mb-lg">
                    <button id="exportCSV" class="btn btn-success">
                        üì• Exportar CSV
                    </button>
                    <button id="exportJSON" class="btn btn-success">
                        üì• Exportar JSON
                    </button>
                    <button id="exportSearchTerms" class="btn btn-secondary">
                        üîç Exportar Termos
                    </button>
                    <button id="copyToClipboard" class="btn btn-secondary">
                        üìã Copiar para √Årea de Transfer√™ncia
                    </button>
                </div>

                <div class="btn-group mb-lg">
                    <button id="exportAllQuestionImages" class="btn btn-primary">
                        üñºÔ∏è Exportar Todas as Perguntas (ZIP)
                    </button>
                    <button id="exportAllAnswerImages" class="btn btn-primary">
                        üñºÔ∏è Exportar Todas as Respostas (ZIP)
                    </button>
                    <button id="exportAllTogether" class="btn btn-primary"
                        style="background: linear-gradient(135deg, var(--color-primary), var(--color-success));">
                        üñºÔ∏è Exportar Tudo (ZIP)
                    </button>
                    <button id="generateNarrative" class="btn btn-secondary">
                        üéôÔ∏è Gerar Narrativa (SRT)
                    </button>
                    <button id="exportCapCut" class="btn btn-primary" style="background: #000; border: 1px solid #333;">
                        üé¨ Exportar Projeto CapCut (BETA)
                    </button>
                    <button id="bulkImportImages" class="btn btn-secondary">
                        üìÅ Importar Imagens em Lote
                    </button>
                    <input type="file" id="bulkImageInput" accept="image/*" multiple style="display: none;">
                    <button id="exportMetadata" class="btn btn-secondary">
                        üíæ Exportar Backup
                    </button>
                    <button id="importMetadata" class="btn btn-secondary">
                        üì• Importar Backup
                    </button>
                    <button id="importProjectHome" class="hidden"></button>
                    <input type="file" id="metadataInput" accept=".json" style="display: none;">
                    <button id="bulkImportBackgrounds" class="btn btn-secondary">
                        üé® Importar Backgrounds em Lote
                    </button>
                    <input type="file" id="bulkBackgroundInput" accept="image/*" multiple style="display: none;">
                </div>

                <div class="btn-group mb-lg">
                    <button id="exportProductionPackage" class="btn btn-primary"
                        style="background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%); width: 100%; font-weight: bold; font-size: 1.1rem; padding: 1rem; border: 1px solid #ffb74d; box-shadow: 0 4px 15px rgba(245, 124, 0, 0.3);">
                        üì¶ Baixar Pacote de Produ√ß√£o COMPLETO (Tudo em Um)
                    </button>
                </div>

                <div class="card-header mt-lg"
                    style="margin-bottom: var(--space-md); border-top: 1px solid var(--glass-border); padding-top: var(--space-lg);">
                    <h3>üìÑ Exportar PDF</h3>
                    <p>Gere documentos PDF com layouts espec√≠ficos</p>
                </div>

                <div class="btn-group mb-lg">
                    <button onclick="exportToPDF('questions-only')" class="btn btn-primary"
                        style="background: #e11d48;">
                        üìï PDF (S√≥ Perguntas)
                    </button>
                    <button onclick="exportToPDF('answers-only')" class="btn btn-primary" style="background: #10b981;">
                        üìó PDF (S√≥ Respostas)
                    </button>
                    <button onclick="exportToPDF('sequential')" class="btn btn-primary" style="background: #6366f1;">
                        üìò PDF (Sequencial)
                    </button>
                    <button onclick="exportToPDF('grouped')" class="btn btn-primary" style="background: #f59e0b;">
                        üìô PDF (Agrupado)
                    </button>
                </div>

                <!-- Global Layout Controls -->
                <div class="global-layout-controls mb-lg glass-card"
                    style="padding: var(--space-md); border: 1px solid var(--primary-main); background: rgba(255, 255, 255, 0.03);">
                    <h3
                        style="margin-bottom: var(--space-sm); font-size: 1.1rem; color: var(--primary-light); display: flex; align-items: center; gap: 8px;">
                        <span>üìê Layout Global</span>
                        <small style="font-size: 0.8rem; font-weight: normal; opacity: 0.8;">(Aplica a todas as quest√µes
                            geradas)</small>
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: var(--space-sm);">
                        <div class="btn-group" style="gap: 10px; display: flex;">
                            <button id="globalLayoutDefault" onclick="applyGlobalLayout('default')"
                                class="btn btn-secondary btn-sm layout-btn active" style="flex: 1;">Padr√£o</button>
                            <button id="globalLayoutImageRight" onclick="applyGlobalLayout('image-right')"
                                class="btn btn-secondary btn-sm layout-btn" style="flex: 1;">Imagem √† Direita</button>
                        </div>
                    </div>
                </div>

                <div id="questionsContainer"></div>
            </div>
        </section>
    </div>

    <!-- Timing Customization Modal -->
    <!-- Regenerate Modal -->
    <div id="regenerateModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content glass-card" style="max-width: 500px;">
            <div class="modal-header">
                <h2>‚ö° Regenerar Quest√£o com IA</h2>
                <button id="closeRegenerateModal" class="btn-close">‚úï</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 15px; opacity: 0.8; font-size: 0.9rem;">Deseja mudar o foco desta quest√£o?
                    Digite abaixo um comando espec√≠fico ou clique em Aleat√≥rio.</p>
                <div class="form-group">
                    <label for="regeneratePrompt" class="form-label">Comando Customizado (Opcional)</label>
                    <textarea id="regeneratePrompt" class="form-textarea"
                        placeholder="Ex: Fa√ßa uma quest√£o sobre a capital da Fran√ßa... ou 'Mude o n√≠vel para dif√≠cil'"
                        style="height: 100px;"></textarea>
                </div>
            </div>
            <div class="modal-footer"
                style="display: flex; gap: var(--space-sm); justify-content: flex-end; margin-top: 20px;">
                <button id="regenerateRandomBtn" class="btn btn-secondary">üé≤ Aleat√≥rio</button>
                <button id="regenerateCustomBtn" class="btn btn-primary">‚ö° Regenerar Agora</button>
            </div>
        </div>
    </div>

    <div id="timingModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content glass-card" style="max-width: 500px;">
            <div class="modal-header">
                <h2>‚è±Ô∏è Configurar Tempos (Segundos)</h2>
                <button id="closeTimingModal" class="btn-close">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-grid" style="grid-template-columns: 1fr;">
                    <div class="form-group">
                        <label for="timeIntro" class="form-label">Introdu√ß√£o</label>
                        <input type="number" id="timeIntro" class="form-input" min="1" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="timeStatement" class="form-label">Pergunta (Enunciado)</label>
                        <input type="number" id="timeStatement" class="form-input" min="1" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="timeAlternatives" class="form-label">Leitura das Alternativas</label>
                        <input type="number" id="timeAlternatives" class="form-input" min="1" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="timeTimer" class="form-label">Tempo do Contador (Timer)</label>
                        <input type="number" id="timeTimer" class="form-input" min="1" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="timeAnswer" class="form-label">Resposta e Justificativa</label>
                        <input type="number" id="timeAnswer" class="form-input" min="1" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="timeCTA" class="form-label">Chamada para A√ß√£o (CTA)</label>
                        <input type="number" id="timeCTA" class="form-input" min="1" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="timeOutro" class="form-label">Encerramento (Outro)</label>
                        <input type="number" id="timeOutro" class="form-input" min="1" step="0.5">
                    </div>
                </div>
                <small class="form-help mt-sm">Esses tempos afetam apenas a exporta√ß√£o para o CapCut no momento.</small>
            </div>
            <div class="modal-footer" style="display: flex; gap: var(--space-sm); justify-content: flex-end;">
                <button id="resetTimingBtn" class="btn btn-secondary">Resetar Padr√£o</button>
                <button id="saveTimingBtn" class="btn btn-primary">Salvar Tempos</button>
            </div>
        </div>
    </div>

    <!-- Brainstorm Modal -->
    <div id="brainstormModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content glass-card"
            style="max-width: 900px; width: 95%; height: 85vh; display: flex; flex-direction: column; padding: 0; overflow: hidden;">
            <div class="modal-header"
                style="padding: 20px; flex-shrink: 0; background: rgba(0,0,0,0.2); border-bottom: 1px solid var(--glass-border);">
                <div style="display: flex; flex-direction: column;">
                    <h2 style="margin: 0; font-size: 1.4rem;">üß† Chat de Estrat√©gia</h2>
                    <p style="margin: 0; font-size: 0.8rem; color: var(--text-tertiary);">Refine suas ideias e estruture
                        seu quiz com IA</p>
                </div>
                <button id="closeBrainstorm" class="btn-close">‚úï</button>
            </div>

            <div id="brainstormChatHistory" class="chat-history"
                style="flex: 1; overflow-y: auto; padding: 25px; display: flex; flex-direction: column; gap: 15px;">
                <!-- Messages will appear here -->
                <div class="chat-message system">
                    <strong>üëã Ol√°! Sou seu estrategista de conte√∫do.</strong><br>
                    Posso ajudar voc√™ a transformar uma ideia vaga em um quiz estruturado. Vamos come√ßar?<br><br>
                    Me diga sobre o que voc√™ quer fazer seu quiz (ex: "Hist√≥ria", "Ci√™ncia", "Filmes anos 80").
                </div>
            </div>

            <div class="chat-input-area"
                style="padding: 20px; border-top: 1px solid var(--glass-border); background: rgba(0, 0, 0, 0.4); flex-shrink: 0;">
                <div style="display: flex; gap: 10px; align-items: flex-end;">
                    <textarea id="brainstormInput" class="form-textarea" rows="2"
                        placeholder="Digite sua ideia ou responda √†s perguntas..."
                        style="resize: none; min-height: 60px; font-size: 0.95rem;"></textarea>
                    <button id="sendBrainstorm" class="btn btn-primary"
                        style="height: 60px; width: 60px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0;">‚û§</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Script -->
    <script src="app.js"></script>
</body>

</html>